{% extends "base.html" %}
{% block title %} System Reports Summary {% endblock %}

{% block content %}
<header>
    <h2 id="pageTitle">ğŸ“ˆ Comprehensive System Reports</h2>
    <p class="subtitle">Summary of all registered users and attendance metrics.</p>
</header>

<section id="report-overview" class="page">
    <h3>ğŸ“Š Overall System Status</h3>
    <div class="grid" style="grid-template-columns: repeat(3, 1fr); gap: 20px;">
        
        <div class="card stat-card" style="border-left: 5px solid var(--accent-primary);">
            <p class="small">Total Registered Teachers</p>
            <div class="stat-value">{{ data.total_teachers }}</div>
        </div>
        
        <div class="card stat-card" style="border-left: 5px solid var(--accent-secondary);">
            <p class="small">Total Enrolled Students</p>
            <div class="stat-value">{{ data.total_students }}</div>
        </div>
        
        <div class="card stat-card" style="border-left: 5px solid var(--accent-tertiary);">
            <p class="small">Lifetime Attendance Entries</p>
            <div class="stat-value">{{ data.total_entries }}</div>
        </div>
    </div>
</section>

---

<section id="report-attendance">
<h3>ğŸ“‹ Today's Attendance Snapshot ({{ today_date }})</h3>
    <div class="grid" style="grid-template-columns: repeat(2, 1fr); gap: 20px;">
        
        <div class="card">
            <h4>Present / Marked</h4>
            <div class="stat-value" style="color: green;">{{ data.present_today }}</div>
            <p class="small">Total students marked present/late today.</p>
        </div>

        <div class="card">
            <h4>Late Arrivals</h4>
            <div class="stat-value" style="color: orange;">{{ data.late_today }}</div>
            <p class="small">Entries marked 'Late' based on policy.</p>
        </div>
    </div>
</section>

---

<section id="report-teachers-approval">
    <h3>ğŸ‘¨â€ğŸ« Pending Approvals</h3>
    <div class="card">
        {% if data.all_unapproved_teachers %}
            <p class="small" style="color: var(--accent-tertiary);">The following teachers require admin approval to log in:</p>
            <ul>
                {% for teacher in data.all_unapproved_teachers %}
                    <li>{{ teacher.name }} ({{ teacher.email }})</li>
                {% endfor %}
            </ul>
            <a href="{{ url_for('dashboard.pending_requests') }}">Review Approval Queue</a>
        {% else %}
            <p style="color: green;">All teacher accounts are currently approved.</p>
        {% endif %}
    </div>
</section>

---

<section id="report-students-recent">
    <h3>ğŸ“ Recently Registered Students</h3>
    <div class="card">
        <p class="small">Last 5 students registered (requires face enrollment).</p>
        <ol>
            {% for student in data.recently_added_students %}
                <li>{{ student.name }} (Roll No: {{ student.roll_no }}) - Face: 
                    {% if student.face_embedding %}âœ…{% else %}âŒ{% endif %}
                </li>
            {% endfor %}
        </ol>
        <a href="{{ url_for('dashboard.manage_students') }}">View All Students</a>
    </div>
</section>

{% endblock %}